<div class="row">
  <div class="col-md-6">
    <h3>Conferences</h3>

    @if (conferences$ | async; as conferences) {

      @if (error) {
        <div class="alert alert-danger">{{ error }}</div>
      }

      @else {
        <table class="table table-sm">
          <thead>
          <tr>
            <th>Title</th>
            <th>Type</th>
            <th>Date</th>
            <th>Durée</th>
            <th>Inscrits</th>
            <th></th>
          </tr>
          </thead>
          <tbody>
            @for (c of conferences; track c.id) {
              <tr>
                <td>{{ c.titre }}</td>
                <td>{{ c.type }}</td>
                <td>{{ c.date | date:'short' }}</td>
                <td>{{ c.duree }}</td>
                <td>{{ c.nbInscrits }}</td>
                <td>
                  <button class="btn btn-sm btn-outline-primary me-1" (click)="edit(c)">Edit</button>
                  <button class="btn btn-sm btn-outline-danger" (click)="deleteOne(c.id)">Delete</button>
                </td>
              </tr>
            } @empty {
              <tr>
                <td colspan="6" class="text-center">No conferences</td>
              </tr>
            }
          </tbody>
        </table>
      }

    } @else {
      <div>Loading...</div>
    }

  </div>

  <div class="col-md-6">
    <h3>{{ editingId ? 'Edit' : 'Create' }} Conference</h3>
    <form [formGroup]="form" (ngSubmit)="submit()">
      <div class="mb-2">
        <label>Titre</label>
        <input formControlName="titre" class="form-control" />
      </div>

      <div class="mb-2">
        <label>Type</label>
        <select formControlName="type" class="form-select">
          @for (t of types; track t) {
            <option [value]="t">{{ t }}</option>
          } @empty {
            <option disabled>-- no types --</option>
          }
        </select>
      </div>

      <div class="mb-2">
        <label>Date</label>
        <input formControlName="date" type="datetime-local" class="form-control" />
      </div>

      <div class="mb-2">
        <label>Durée (minutes)</label>
        <input formControlName="duree" type="number" class="form-control" />
      </div>

      <div class="mb-2">
        <label>Keynote IDs (comma separated)</label>
        <input formControlName="keynoteIds" class="form-control" />
      </div>

      <div>
        <button class="btn btn-primary" [disabled]="form.invalid">{{ editingId ? 'Update' : 'Create' }}</button>
        <button type="button" class="btn btn-secondary ms-2" (click)="reset()">Reset</button>
      </div>
    </form>
  </div>
</div>
